!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):t.cryptico=r()}(this,function(){"use strict";function t(t,r,i){null!=t&&("number"==typeof t?this.fromNumber(t,r,i):null==r&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,r))}function r(){return new t(null)}function i(t,r,i,o,n,e){for(;--e>=0;){var s=r*this[t++]+i[o]+n;n=Math.floor(s/67108864),i[o++]=67108863&s}return n}function o(t,r,i,o,n,e){for(var s=32767&r,h=r>>15;--e>=0;){var u=32767&this[t],a=this[t++]>>15,f=h*u+a*s;u=s*u+((32767&f)<<15)+i[o]+(1073741823&n),n=(u>>>30)+(f>>>15)+h*a+(n>>>30),i[o++]=1073741823&u}return n}function n(t,r,i,o,n,e){for(var s=16383&r,h=r>>14;--e>=0;){var u=16383&this[t],a=this[t++]>>14,f=h*u+a*s;u=s*u+((16383&f)<<14)+i[o]+n,n=(u>>28)+(f>>14)+h*a,i[o++]=268435455&u}return n}function e(t){return kr.charAt(t)}function s(t,r){var i=Fr[t.charCodeAt(r)];return null==i?-1:i}function h(t){for(var r=this.t-1;r>=0;--r)t[r]=this[r];t.t=this.t,t.s=this.s}function u(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+DV:this.t=0}function a(t){var i=r();return i.fromInt(t),i}function f(r,i){var o;if(16==i)o=4;else if(8==i)o=3;else if(256==i)o=8;else if(2==i)o=1;else if(32==i)o=5;else{if(4!=i)return void this.fromRadix(r,i);o=2}this.t=0,this.s=0;for(var n=r.length,e=!1,h=0;--n>=0;){var u=8==o?255&r[n]:s(r,n);u<0?"-"==r.charAt(n)&&(e=!0):(e=!1,0==h?this[this.t++]=u:h+o>this.DB?(this[this.t-1]|=(u&(1<<this.DB-h)-1)<<h,this[this.t++]=u>>this.DB-h):this[this.t-1]|=u<<h,h+=o,h>=this.DB&&(h-=this.DB))}8==o&&0!=(128&r[0])&&(this.s=-1,h>0&&(this[this.t-1]|=(1<<this.DB-h)-1<<h)),this.clamp(),e&&t.ZERO.subTo(this,this)}function c(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function p(t){if(this.s<0)return"-"+this.negate().toString(t);var r;if(16==t)r=4;else if(8==t)r=3;else if(2==t)r=1;else if(32==t)r=5;else if(64==t)r=6;else{if(4!=t)return this.toRadix(t);r=2}var i,o=(1<<r)-1,n=!1,s="",h=this.t,u=this.DB-h*this.DB%r;if(h-- >0)for(u<this.DB&&(i=this[h]>>u)>0&&(n=!0,s=e(i));h>=0;)u<r?(i=(this[h]&(1<<u)-1)<<r-u,i|=this[--h]>>(u+=this.DB-r)):(i=this[h]>>(u-=r)&o,u<=0&&(u+=this.DB,--h)),i>0&&(n=!0),n&&(s+=e(i));return n?s:"0"}function l(){var i=r();return t.ZERO.subTo(this,i),i}function v(){return this.s<0?this.negate():this}function m(t){var r=this.s-t.s;if(0!=r)return r;var i=this.t;if(r=i-t.t,0!=r)return r;for(;--i>=0;)if(0!=(r=this[i]-t[i]))return r;return 0}function d(t){var r,i=1;return 0!=(r=t>>>16)&&(t=r,i+=16),0!=(r=t>>8)&&(t=r,i+=8),0!=(r=t>>4)&&(t=r,i+=4),0!=(r=t>>2)&&(t=r,i+=2),0!=(r=t>>1)&&(t=r,i+=1),i}function y(){return this.t<=0?0:this.DB*(this.t-1)+d(this[this.t-1]^this.s&this.DM)}function g(t,r){var i;for(i=this.t-1;i>=0;--i)r[i+t]=this[i];for(i=t-1;i>=0;--i)r[i]=0;r.t=this.t+t,r.s=this.s}function b(t,r){for(var i=t;i<this.t;++i)r[i-t]=this[i];r.t=Math.max(this.t-t,0),r.s=this.s}function S(t,r){var i,o=t%this.DB,n=this.DB-o,e=(1<<n)-1,s=Math.floor(t/this.DB),h=this.s<<o&this.DM;for(i=this.t-1;i>=0;--i)r[i+s+1]=this[i]>>n|h,h=(this[i]&e)<<o;for(i=s-1;i>=0;--i)r[i]=0;r[s]=h,r.t=this.t+s+1,r.s=this.s,r.clamp()}function T(t,r){r.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t)return void(r.t=0);var o=t%this.DB,n=this.DB-o,e=(1<<o)-1;r[0]=this[i]>>o;for(var s=i+1;s<this.t;++s)r[s-i-1]|=(this[s]&e)<<n,r[s-i]=this[s]>>o;o>0&&(r[this.t-i-1]|=(this.s&e)<<n),r.t=this.t-i,r.clamp()}function w(t,r){for(var i=0,o=0,n=Math.min(t.t,this.t);i<n;)o+=this[i]-t[i],r[i++]=o&this.DM,o>>=this.DB;if(t.t<this.t){for(o-=t.s;i<this.t;)o+=this[i],r[i++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;i<t.t;)o-=t[i],r[i++]=o&this.DM,o>>=this.DB;o-=t.s}r.s=o<0?-1:0,o<-1?r[i++]=this.DV+o:o>0&&(r[i++]=o),r.t=i,r.clamp()}function C(r,i){var o=this.abs(),n=r.abs(),e=o.t;for(i.t=e+n.t;--e>=0;)i[e]=0;for(e=0;e<n.t;++e)i[e+o.t]=o.am(0,n[e],i,e,0,o.t);i.s=0,i.clamp(),this.s!=r.s&&t.ZERO.subTo(i,i)}function D(t){for(var r=this.abs(),i=t.t=2*r.t;--i>=0;)t[i]=0;for(i=0;i<r.t-1;++i){var o=r.am(i,r[i],t,2*i,0,1);(t[i+r.t]+=r.am(i+1,2*r[i],t,2*i+1,o,r.t-i-1))>=r.DV&&(t[i+r.t]-=r.DV,t[i+r.t+1]=1)}t.t>0&&(t[t.t-1]+=r.am(i,r[i],t,2*i,0,1)),t.s=0,t.clamp()}function A(i,o,n){var e=i.abs();if(!(e.t<=0)){var s=this.abs();if(s.t<e.t)return null!=o&&o.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=r());var h=r(),u=this.s,a=i.s,f=this.DB-d(e[e.t-1]);f>0?(e.lShiftTo(f,h),s.lShiftTo(f,n)):(e.copyTo(h),s.copyTo(n));var c=h.t,p=h[c-1];if(0!=p){var l=p*(1<<this.F1)+(c>1?h[c-2]>>this.F2:0),v=this.FV/l,m=(1<<this.F1)/l,y=1<<this.F2,g=n.t,b=g-c,S=null==o?r():o;for(h.dlShiftTo(b,S),n.compareTo(S)>=0&&(n[n.t++]=1,n.subTo(S,n)),t.ONE.dlShiftTo(c,S),S.subTo(h,h);h.t<c;)h[h.t++]=0;for(;--b>=0;){var T=n[--g]==p?this.DM:Math.floor(n[g]*v+(n[g-1]+y)*m);if((n[g]+=h.am(0,T,n,b,0,c))<T)for(h.dlShiftTo(b,S),n.subTo(S,n);n[g]<--T;)n.subTo(S,n)}null!=o&&(n.drShiftTo(c,o),u!=a&&t.ZERO.subTo(o,o)),n.t=c,n.clamp(),f>0&&n.rShiftTo(f,n),u<0&&t.ZERO.subTo(n,n)}}}function x(i){var o=r();return this.abs().divRemTo(i,null,o),this.s<0&&o.compareTo(t.ZERO)>0&&i.subTo(o,o),o}function B(t){this.m=t}function R(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function E(t){return t}function M(t){t.divRemTo(this.m,null,t)}function I(t,r,i){t.multiplyTo(r,i),this.reduce(i)}function O(t,r){t.squareTo(r),this.reduce(r)}function q(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var r=3&t;return r=r*(2-(15&t)*r)&15,r=r*(2-(255&t)*r)&255,r=r*(2-((65535&t)*r&65535))&65535,r=r*(2-t*r%this.DV)%this.DV,r>0?this.DV-r:-r}function P(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function N(i){var o=r();return i.abs().dlShiftTo(this.m.t,o),o.divRemTo(this.m,null,o),i.s<0&&o.compareTo(t.ZERO)>0&&this.m.subTo(o,o),o}function K(t){var i=r();return t.copyTo(i),this.reduce(i),i}function V(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var r=0;r<this.m.t;++r){var i=32767&t[r],o=i*this.mpl+((i*this.mph+(t[r]>>15)*this.mpl&this.um)<<15)&t.DM;for(i=r+this.m.t,t[i]+=this.m.am(0,o,t,r,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function L(t,r){t.squareTo(r),this.reduce(r)}function k(t,r,i){t.multiplyTo(r,i),this.reduce(i)}function F(){return 0==(this.t>0?1&this[0]:this.s)}function j(i,o){if(i>4294967295||i<1)return t.ONE;var n=r(),e=r(),s=o.convert(this),h=d(i)-1;for(s.copyTo(n);--h>=0;)if(o.sqrTo(n,e),(i&1<<h)>0)o.mulTo(e,s,n);else{var u=n;n=e,e=u}return o.revert(n)}function Z(t,r){var i;return i=t<256||r.isEven()?new B(r):new P(r),this.exp(t,i)}function _(){var t=r();return this.copyTo(t),t}function z(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function H(){return 0==this.t?this.s:this[0]<<24>>24}function X(){return 0==this.t?this.s:this[0]<<16>>16}function U(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function W(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function G(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var i=this.chunkSize(t),o=Math.pow(t,i),n=a(o),e=r(),s=r(),h="";for(this.divRemTo(n,e,s);e.signum()>0;)h=(o+s.intValue()).toString(t).substr(1)+h,e.divRemTo(n,e,s);return s.intValue().toString(t)+h}function J(r,i){this.fromInt(0),null==i&&(i=10);for(var o=this.chunkSize(i),n=Math.pow(i,o),e=!1,h=0,u=0,a=0;a<r.length;++a){var f=s(r,a);f<0?"-"==r.charAt(a)&&0==this.signum()&&(e=!0):(u=i*u+f,++h>=o&&(this.dMultiply(n),this.dAddOffset(u,0),h=0,u=0))}h>0&&(this.dMultiply(Math.pow(i,h)),this.dAddOffset(u,0)),e&&t.ZERO.subTo(this,this)}function Q(r,i,o){if("number"==typeof i)if(r<2)this.fromInt(1);else for(this.fromNumber(r,o),this.testBit(r-1)||this.bitwiseTo(t.ONE.shiftLeft(r-1),et,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(i);)this.dAddOffset(2,0),this.bitLength()>r&&this.subTo(t.ONE.shiftLeft(r-1),this);else{var n=[],e=7&r;n.length=(r>>3)+1,i.nextBytes(n),e>0?n[0]&=(1<<e)-1:n[0]=0,this.fromString(n,256)}}function Y(){var t=this.t,r=[];r[0]=this.s;var i,o=this.DB-t*this.DB%8,n=0;if(t-- >0)for(o<this.DB&&(i=this[t]>>o)!=(this.s&this.DM)>>o&&(r[n++]=i|this.s<<this.DB-o);t>=0;)o<8?(i=(this[t]&(1<<o)-1)<<8-o,i|=this[--t]>>(o+=this.DB-8)):(i=this[t]>>(o-=8)&255,o<=0&&(o+=this.DB,--t)),0!=(128&i)&&(i|=-256),0==n&&(128&this.s)!=(128&i)&&++n,(n>0||i!=this.s)&&(r[n++]=i);return r}function $(t){return 0==this.compareTo(t)}function tt(t){return this.compareTo(t)<0?this:t}function rt(t){return this.compareTo(t)>0?this:t}function it(t,r,i){var o,n,e=Math.min(t.t,this.t);for(o=0;o<e;++o)i[o]=r(this[o],t[o]);if(t.t<this.t){for(n=t.s&this.DM,o=e;o<this.t;++o)i[o]=r(this[o],n);i.t=this.t}else{for(n=this.s&this.DM,o=e;o<t.t;++o)i[o]=r(n,t[o]);i.t=t.t}i.s=r(this.s,t.s),i.clamp()}function ot(t,r){return t&r}function nt(t){var i=r();return this.bitwiseTo(t,ot,i),i}function et(t,r){return t|r}function st(t){var i=r();return this.bitwiseTo(t,et,i),i}function ht(t,r){return t^r}function ut(t){var i=r();return this.bitwiseTo(t,ht,i),i}function at(t,r){return t&~r}function ft(t){var i=r();return this.bitwiseTo(t,at,i),i}function ct(){for(var t=r(),i=0;i<this.t;++i)t[i]=this.DM&~this[i];return t.t=this.t,t.s=~this.s,t}function pt(t){var i=r();return t<0?this.rShiftTo(-t,i):this.lShiftTo(t,i),i}function lt(t){var i=r();return t<0?this.lShiftTo(-t,i):this.rShiftTo(t,i),i}function vt(t){if(0==t)return-1;var r=0;return 0==(65535&t)&&(t>>=16,r+=16),0==(255&t)&&(t>>=8,r+=8),0==(15&t)&&(t>>=4,r+=4),0==(3&t)&&(t>>=2,r+=2),0==(1&t)&&++r,r}function mt(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+vt(this[t]);return this.s<0?this.t*this.DB:-1}function dt(t){for(var r=0;0!=t;)t&=t-1,++r;return r}function yt(){for(var t=0,r=this.s&this.DM,i=0;i<this.t;++i)t+=dt(this[i]^r);return t}function gt(t){var r=Math.floor(t/this.DB);return r>=this.t?0!=this.s:0!=(this[r]&1<<t%this.DB)}function bt(r,i){var o=t.ONE.shiftLeft(r);return this.bitwiseTo(o,i,o),o}function St(t){return this.changeBit(t,et)}function Tt(t){return this.changeBit(t,at)}function wt(t){return this.changeBit(t,ht)}function Ct(t,r){for(var i=0,o=0,n=Math.min(t.t,this.t);i<n;)o+=this[i]+t[i],r[i++]=o&this.DM,o>>=this.DB;if(t.t<this.t){for(o+=t.s;i<this.t;)o+=this[i],r[i++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;i<t.t;)o+=t[i],r[i++]=o&this.DM,o>>=this.DB;o+=t.s}r.s=o<0?-1:0,o>0?r[i++]=o:o<-1&&(r[i++]=this.DV+o),r.t=i,r.clamp()}function Dt(t){var i=r();return this.addTo(t,i),i}function At(t){var i=r();return this.subTo(t,i),i}function xt(t){var i=r();return this.multiplyTo(t,i),i}function Bt(){var t=r();return this.squareTo(t),t}function Rt(t){var i=r();return this.divRemTo(t,i,null),i}function Et(t){var i=r();return this.divRemTo(t,null,i),i}function Mt(t){var i=r(),o=r();return this.divRemTo(t,i,o),[i,o]}function It(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Ot(t,r){if(0!=t){for(;this.t<=r;)this[this.t++]=0;for(this[r]+=t;this[r]>=this.DV;)this[r]-=this.DV,++r>=this.t&&(this[this.t++]=0),++this[r]}}function qt(){}function Pt(t){return t}function Nt(t,r,i){t.multiplyTo(r,i)}function Kt(t,r){t.squareTo(r)}function Vt(t){return this.exp(t,new qt)}function Lt(t,r,i){var o=Math.min(this.t+t.t,r);for(i.s=0,i.t=o;o>0;)i[--o]=0;var n;for(n=i.t-this.t;o<n;++o)i[o+this.t]=this.am(0,t[o],i,o,0,this.t);for(n=Math.min(t.t,r);o<n;++o)this.am(0,t[o],i,o,0,r-o);i.clamp()}function kt(t,r,i){--r;var o=i.t=this.t+t.t-r;for(i.s=0;--o>=0;)i[o]=0;for(o=Math.max(r-this.t,0);o<t.t;++o)i[this.t+o-r]=this.am(r-o,t[o],i,0,0,this.t+o-r);i.clamp(),i.drShiftTo(1,i)}function Ft(i){this.r2=r(),this.q3=r(),t.ONE.dlShiftTo(2*i.t,this.r2),this.mu=this.r2.divide(i),this.m=i}function jt(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var i=r();return t.copyTo(i),this.reduce(i),i}function Zt(t){return t}function _t(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function zt(t,r){t.squareTo(r),this.reduce(r)}function Ht(t,r,i){t.multiplyTo(r,i),this.reduce(i)}function Xt(t,i){var o,n,e=t.bitLength(),s=a(1);if(e<=0)return s;o=e<18?1:e<48?3:e<144?4:e<768?5:6,n=e<8?new B(i):i.isEven()?new Ft(i):new P(i);var h=[],u=3,f=o-1,c=(1<<o)-1;if(h[1]=n.convert(this),o>1){var p=r();for(n.sqrTo(h[1],p);u<=c;)h[u]=r(),n.mulTo(p,h[u-2],h[u]),u+=2}var l,v,m=t.t-1,y=!0,g=r();for(e=d(t[m])-1;m>=0;){for(e>=f?l=t[m]>>e-f&c:(l=(t[m]&(1<<e+1)-1)<<f-e,m>0&&(l|=t[m-1]>>this.DB+e-f)),u=o;0==(1&l);)l>>=1,--u;if((e-=u)<0&&(e+=this.DB,--m),y)h[l].copyTo(s),y=!1;else{for(;u>1;)n.sqrTo(s,g),n.sqrTo(g,s),u-=2;u>0?n.sqrTo(s,g):(v=s,s=g,g=v),n.mulTo(g,h[l],s)}for(;m>=0&&0==(t[m]&1<<e);)n.sqrTo(s,g),v=s,s=g,g=v,--e<0&&(e=this.DB-1,--m)}return n.revert(s)}function Ut(t){var r=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(r.compareTo(i)<0){var o=r;r=i,i=o}var n=r.getLowestSetBit(),e=i.getLowestSetBit();if(e<0)return r;for(n<e&&(e=n),e>0&&(r.rShiftTo(e,r),i.rShiftTo(e,i));r.signum()>0;)(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),(n=i.getLowestSetBit())>0&&i.rShiftTo(n,i),r.compareTo(i)>=0?(r.subTo(i,r),r.rShiftTo(1,r)):(i.subTo(r,i),i.rShiftTo(1,i));return e>0&&i.lShiftTo(e,i),i}function Wt(t){if(t<=0)return 0;var r=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(0==r)i=this[0]%t;else for(var o=this.t-1;o>=0;--o)i=(r*i+this[o])%t;return i}function Gt(r){var i=r.isEven();if(this.isEven()&&i||0==r.signum())return t.ZERO;for(var o=r.clone(),n=this.clone(),e=a(1),s=a(0),h=a(0),u=a(1);0!=o.signum();){for(;o.isEven();)o.rShiftTo(1,o),i?(e.isEven()&&s.isEven()||(e.addTo(this,e),s.subTo(r,s)),e.rShiftTo(1,e)):s.isEven()||s.subTo(r,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),i?(h.isEven()&&u.isEven()||(h.addTo(this,h),u.subTo(r,u)),h.rShiftTo(1,h)):u.isEven()||u.subTo(r,u),u.rShiftTo(1,u);o.compareTo(n)>=0?(o.subTo(n,o),i&&e.subTo(h,e),s.subTo(u,s)):(n.subTo(o,n),i&&h.subTo(e,h),u.subTo(s,u))}return 0!=n.compareTo(t.ONE)?t.ZERO:u.compareTo(r)>=0?u.subtract(r):u.signum()<0?(u.addTo(r,u),u.signum()<0?u.add(r):u):u}function Jt(t){var r,i=this.abs();if(1==i.t&&i[0]<=jr[jr.length-1]){for(r=0;r<jr.length;++r)if(i[0]==jr[r])return!0;return!1}if(i.isEven())return!1;for(r=1;r<jr.length;){for(var o=jr[r],n=r+1;n<jr.length&&o<Zr;)o*=jr[n++];for(o=i.modInt(o);r<n;)if(o%jr[r++]==0)return!1}return i.millerRabin(t)}function Qt(i){var o=this.subtract(t.ONE),n=o.getLowestSetBit();if(n<=0)return!1;var e=o.shiftRight(n);i=i+1>>1,i>jr.length&&(i=jr.length);for(var s=r(),h=0;h<i;++h){s.fromInt(jr[Math.floor(Math.random()*jr.length)]);var u=s.modPow(e,this);if(0!=u.compareTo(t.ONE)&&0!=u.compareTo(o)){for(var a=1;a++<n&&0!=u.compareTo(o);)if(u=u.modPowInt(2,this),0==u.compareTo(t.ONE))return!1;if(0!=u.compareTo(o))return!1}}return!0}function Yt(t){function r(t,r){var i=(65535&t)+(65535&r),o=(t>>16)+(r>>16)+(i>>16);return o<<16|65535&i}function i(t,r){return t>>>r|t<<32-r}function o(t,r){return t>>>r}function n(t,r,i){return t&r^~t&i}function e(t,r,i){return t&r^t&i^r&i}function s(t){return i(t,2)^i(t,13)^i(t,22)}function h(t){return i(t,6)^i(t,11)^i(t,25)}function u(t){return i(t,7)^i(t,18)^o(t,3)}function a(t){return i(t,17)^i(t,19)^o(t,10)}function f(t,i){var o,f,c,p,l,v,m,d,y,g,b,S,T=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],w=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],C=new Array(64);t[i>>5]|=128<<24-i%32,t[(i+64>>9<<4)+15]=i;for(var y=0;y<t.length;y+=16){o=w[0],f=w[1],c=w[2],p=w[3],l=w[4],v=w[5],m=w[6],d=w[7];for(var g=0;g<64;g++)g<16?C[g]=t[g+y]:C[g]=r(r(r(a(C[g-2]),C[g-7]),u(C[g-15])),C[g-16]),b=r(r(r(r(d,h(l)),n(l,v,m)),T[g]),C[g]),S=r(s(o),e(o,f,c)),d=m,m=v,v=l,l=r(p,b),p=c,c=f,f=o,o=r(b,S);w[0]=r(o,w[0]),w[1]=r(f,w[1]),w[2]=r(c,w[2]),w[3]=r(p,w[3]),w[4]=r(l,w[4]),w[5]=r(v,w[5]),w[6]=r(m,w[6]),w[7]=r(d,w[7])}return w}function c(t){for(var r=[],i=(1<<v)-1,o=0;o<t.length*v;o+=v)r[o>>5]|=(t.charCodeAt(o/v)&i)<<24-o%32;return r}function p(t){t=t.replace(/\r\n/g,"\n");for(var r="",i=0;i<t.length;i++){var o=t.charCodeAt(i);o<128?r+=String.fromCharCode(o):o>127&&o<2048?(r+=String.fromCharCode(o>>6|192),r+=String.fromCharCode(63&o|128)):(r+=String.fromCharCode(o>>12|224),r+=String.fromCharCode(o>>6&63|128),r+=String.fromCharCode(63&o|128))}return r}function l(t){for(var r=m?"0123456789ABCDEF":"0123456789abcdef",i="",o=0;o<4*t.length;o++)i+=r.charAt(t[o>>2]>>8*(3-o%4)+4&15)+r.charAt(t[o>>2]>>8*(3-o%4)&15);return i}var v=8,m=0;return t=p(t),l(f(c(t),t.length*v))}function $t(t){function r(t,r){return t<<r|t>>>32-r}function i(t){var r,i,o="";for(r=7;r>=0;r--)i=t>>>4*r&15,o+=i.toString(16);return o}function o(t){t=t.replace(/\r\n/g,"\n");for(var r="",i=0;i<t.length;i++){var o=t.charCodeAt(i);o<128?r+=String.fromCharCode(o):o>127&&o<2048?(r+=String.fromCharCode(o>>6|192),r+=String.fromCharCode(63&o|128)):(r+=String.fromCharCode(o>>12|224),r+=String.fromCharCode(o>>6&63|128),r+=String.fromCharCode(63&o|128))}return r}var n,e,s,h,u,a,f,c,p,l=new Array(80),v=1732584193,m=4023233417,d=2562383102,y=271733878,g=3285377520;t=o(t);var b=t.length,S=[];for(e=0;e<b-3;e+=4)s=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),S.push(s);switch(b%4){case 0:e=2147483648;break;case 1:e=t.charCodeAt(b-1)<<24|8388608;break;case 2:e=t.charCodeAt(b-2)<<24|t.charCodeAt(b-1)<<16|32768;break;case 3:e=t.charCodeAt(b-3)<<24|t.charCodeAt(b-2)<<16|t.charCodeAt(b-1)<<8|128}for(S.push(e);S.length%16!=14;)S.push(0);for(S.push(b>>>29),S.push(b<<3&4294967295),n=0;n<S.length;n+=16){for(e=0;e<16;e++)l[e]=S[n+e];for(e=16;e<=79;e++)l[e]=r(l[e-3]^l[e-8]^l[e-14]^l[e-16],1);for(h=v,u=m,a=d,f=y,c=g,e=0;e<=19;e++)p=r(h,5)+(u&a|~u&f)+c+l[e]+1518500249&4294967295,c=f,f=a,a=r(u,30),u=h,h=p;for(e=20;e<=39;e++)p=r(h,5)+(u^a^f)+c+l[e]+1859775393&4294967295,c=f,f=a,a=r(u,30),u=h,h=p;for(e=40;e<=59;e++)p=r(h,5)+(u&a|u&f|a&f)+c+l[e]+2400959708&4294967295,c=f,f=a,a=r(u,30),u=h,h=p;for(e=60;e<=79;e++)p=r(h,5)+(u^a^f)+c+l[e]+3395469782&4294967295,c=f,f=a,a=r(u,30),u=h,h=p;v=v+h&4294967295,m=m+u&4294967295,d=d+a&4294967295,y=y+f&4294967295,g=g+c&4294967295}return p=i(v)+i(m)+i(d)+i(y)+i(g),p.toLowerCase()}function tr(){}function rr(t){var r;for(r=0;r<t.length;r++)t[r]=Math.floor(256*Math.random())}function ir(){this.i=0,this.j=0,this.S=[]}function or(t){var r,i,o;for(r=0;r<256;++r)this.S[r]=r;for(i=0,r=0;r<256;++r)i=i+this.S[r]+t[r%t.length]&255,o=this.S[r],this.S[r]=this.S[i],this.S[i]=o;this.i=0,this.j=0}function nr(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function er(){return new ir}function sr(t){Gr[Jr++]^=255&t,Gr[Jr++]^=t>>8&255,Gr[Jr++]^=t>>16&255,Gr[Jr++]^=t>>24&255,Jr>=Qr&&(Jr-=Qr)}function hr(){sr((new Date).getTime())}function ur(){if(null==Wr){for(hr(),Wr=er(),Wr.init(Gr),Jr=0;Jr<Gr.length;++Jr)Gr[Jr]=0;Jr=0}return Wr.next()}function ar(t){var r;for(r=0;r<t.length;++r)t[r]=ur()}function fr(){}function cr(t,r){return new ni(t,r)}function pr(t,r){if(r<t.length+11)throw"Message too long for RSA (n="+r+", l="+t.length+")";for(var i=[],o=t.length-1;o>=0&&r>0;){var n=t.charCodeAt(o--);n<128?i[--r]=n:n>127&&n<2048?(i[--r]=63&n|128,i[--r]=n>>6|192):(i[--r]=63&n|128,i[--r]=n>>6&63|128,i[--r]=n>>12|224)}i[--r]=0;for(var e=new oi.SecureRandom,s=[];r>2;){for(s[0]=0;0==s[0];)e.nextBytes(s);i[--r]=s[0]}return i[--r]=2,i[--r]=0,new ni(i)}function lr(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function vr(t,r){null!=t&&null!=r&&t.length>0&&r.length>0?(this.n=cr(t,16),this.e=parseInt(r,16)):alert("Invalid RSA public key")}function mr(t){return t.modPowInt(this.e,this.n)}function dr(t){var r=pr(t,this.n.bitLength()+7>>3);if(null==r)return null;var i=this.doPublic(r);if(null==i)return null;var o=i.toString(16);return 0==(1&o.length)?o:"0"+o}function yr(t,r){for(var i=t.toByteArray(),o=0;o<i.length&&0==i[o];)++o;if(i.length-o!=r-1||2!=i[o])return null;for(++o;0!=i[o];)if(++o>=i.length)return null;for(var n="";++o<i.length;){var e=255&i[o];e<128?n+=String.fromCharCode(e):e>191&&e<224?(n+=String.fromCharCode((31&e)<<6|63&i[o+1]),++o):(n+=String.fromCharCode((15&e)<<12|(63&i[o+1])<<6|63&i[o+2]),o+=2)}return n}function gr(t,r,i){null!=t&&null!=r&&t.length>0&&r.length>0?(this.n=cr(t,16),this.e=parseInt(r,16),this.d=cr(i,16)):alert("Invalid RSA private key")}function br(t,r,i,o,n,e,s,h){null!=t&&null!=r&&t.length>0&&r.length>0?(this.n=cr(t,16),this.e=parseInt(r,16),this.d=cr(i,16),this.p=cr(o,16),this.q=cr(n,16),this.dmp1=cr(e,16),this.dmq1=cr(s,16),this.coeff=cr(h,16)):alert("Invalid RSA private key")}function Sr(t,r){var i=new oi.SeededRandom,o=t>>1;this.e=parseInt(r,16);for(var n=new ni(r,16);;){for(;this.p=new ni(t-o,1,i),0!=this.p.subtract(ni.ONE).gcd(n).compareTo(ni.ONE)||!this.p.isProbablePrime(10););for(;this.q=new ni(o,1,i),0!=this.q.subtract(ni.ONE).gcd(n).compareTo(ni.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var e=this.p;this.p=this.q,this.q=e}var s=this.p.subtract(ni.ONE),h=this.q.subtract(ni.ONE),u=s.multiply(h);if(0==u.gcd(n).compareTo(ni.ONE)){this.n=this.p.multiply(this.q),this.d=n.modInverse(u),this.dmp1=this.d.mod(s),this.dmq1=this.d.mod(h),this.coeff=this.q.modInverse(this.p);break}}}function Tr(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var r=t.mod(this.p).modPow(this.dmp1,this.p),i=t.mod(this.q).modPow(this.dmq1,this.q);r.compareTo(i)<0;)r=r.add(this.p);return r.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)}function wr(t){var r=cr(t,16),i=this.doPrivate(r);return null==i?null:yr(i,this.n.bitLength()+7>>3)}function Cr(t,r,i){for(var o=r/4,n=si[i],e=n(t),s="0001",h="00"+ei[i]+e,u="",a=o-s.length-h.length,f=0;f<a;f+=2)u+="ff";var c=s+u+h;return c}function Dr(t,r){var i=Cr(t,this.n.bitLength(),r),o=cr(i,16),n=this.doPrivate(o),e=n.toString(16);return e}function Ar(t){var r=Cr(t,this.n.bitLength(),"sha1"),i=cr(r,16),o=this.doPrivate(i),n=o.toString(16);return n}function xr(t){var r=Cr(t,this.n.bitLength(),"sha256"),i=cr(r,16),o=this.doPrivate(i),n=o.toString(16);return n}function Br(t,r,i){var o=new lr;o.setPublic(r,i);var n=o.doPublic(t);return n}function Rr(t,r,i){var o=Br(t,r,i),n=o.toString(16).replace(/^1f+00/,"");return n}function Er(t){for(var r in ei){var i=ei[r],o=i.length;if(t.substring(0,o)==i){var n=[r,t.substring(o)];return n}}return[]}function Mr(t,r,i,o){var n=Rr(r,i,o),e=Er(n);if(0==e.length)return!1;var s=e[0],h=e[1],u=si[s],a=u(t);return h==a}function Ir(t,r){var i=cr(t,16),o=Mr(r,i,this.n.toString(16),this.e.toString(16));return o}function Or(t,r){r=r.replace(/[ \n]+/g,"");var i=cr(r,16),o=this.doPublic(i),n=o.toString(16).replace(/^1f+00/,""),e=Er(n);if(0==e.length)return!1;var s=e[0],h=e[1],u=si[s],a=u(t);return h==a}var qr,Pr=0xdeadbeefcafe,Nr=15715070==(16777215&Pr);Nr&&"Microsoft Internet Explorer"==navigator.appName?(t.prototype.am=o,qr=30):Nr&&"Netscape"!=navigator.appName?(t.prototype.am=i,qr=26):(t.prototype.am=n,qr=28),t.prototype.DB=qr,t.prototype.DM=(1<<qr)-1,t.prototype.DV=1<<qr;var Kr=52;t.prototype.FV=Math.pow(2,Kr),t.prototype.F1=Kr-qr,t.prototype.F2=2*qr-Kr;var Vr,Lr,kr="0123456789abcdefghijklmnopqrstuvwxyz",Fr=[];for(Vr="0".charCodeAt(0),Lr=0;Lr<=9;++Lr)Fr[Vr++]=Lr;for(Vr="a".charCodeAt(0),Lr=10;Lr<36;++Lr)Fr[Vr++]=Lr;for(Vr="A".charCodeAt(0),Lr=10;Lr<36;++Lr)Fr[Vr++]=Lr;B.prototype.convert=R,B.prototype.revert=E,B.prototype.reduce=M,B.prototype.mulTo=I,B.prototype.sqrTo=O,P.prototype.convert=N,P.prototype.revert=K,P.prototype.reduce=V,P.prototype.mulTo=k,P.prototype.sqrTo=L,t.prototype.copyTo=h,t.prototype.fromInt=u,t.prototype.fromString=f,t.prototype.clamp=c,t.prototype.dlShiftTo=g,t.prototype.drShiftTo=b,t.prototype.lShiftTo=S,t.prototype.rShiftTo=T,t.prototype.subTo=w,t.prototype.multiplyTo=C,t.prototype.squareTo=D,t.prototype.divRemTo=A,t.prototype.invDigit=q,t.prototype.isEven=F,t.prototype.exp=j,t.prototype.toString=p,t.prototype.negate=l,t.prototype.abs=v,t.prototype.compareTo=m,t.prototype.bitLength=y,t.prototype.mod=x,t.prototype.modPowInt=Z,t.ZERO=a(0),t.ONE=a(1),qt.prototype.convert=Pt,qt.prototype.revert=Pt,qt.prototype.mulTo=Nt,qt.prototype.sqrTo=Kt,Ft.prototype.convert=jt,Ft.prototype.revert=Zt,Ft.prototype.reduce=_t,Ft.prototype.mulTo=Ht,Ft.prototype.sqrTo=zt;var jr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Zr=(1<<26)/jr[jr.length-1];t.prototype.chunkSize=U,t.prototype.toRadix=G,t.prototype.fromRadix=J,t.prototype.fromNumber=Q,t.prototype.bitwiseTo=it,t.prototype.changeBit=bt,t.prototype.addTo=Ct,t.prototype.dMultiply=It,t.prototype.dAddOffset=Ot,t.prototype.multiplyLowerTo=Lt,t.prototype.multiplyUpperTo=kt,t.prototype.modInt=Wt,t.prototype.millerRabin=Qt,t.prototype.clone=_,t.prototype.intValue=z,t.prototype.byteValue=H,t.prototype.shortValue=X,t.prototype.signum=W,t.prototype.toByteArray=Y,t.prototype.equals=$,t.prototype.min=tt,t.prototype.max=rt,t.prototype.and=nt,t.prototype.or=st,t.prototype.xor=ut,t.prototype.andNot=ft,t.prototype.not=ct,t.prototype.shiftLeft=pt,t.prototype.shiftRight=lt,t.prototype.getLowestSetBit=mt,t.prototype.bitCount=yt,t.prototype.testBit=gt,t.prototype.setBit=St,t.prototype.clearBit=Tt,t.prototype.flipBit=wt,t.prototype.add=Dt,t.prototype.subtract=At,t.prototype.multiply=xt,t.prototype.divide=Rt,t.prototype.remainder=Et,t.prototype.divideAndRemainder=Mt,t.prototype.modPow=Xt,t.prototype.modInverse=Gt,t.prototype.pow=Vt,t.prototype.gcd=Ut,t.prototype.isProbablePrime=Jt,t.prototype.square=Bt;var _r={BigInteger:t,int2char:e},zr={};zr.hex=function(t){return Yt(t)};var Hr={};Hr.hex=function(t){return $t(t)};var Xr=function(t){function r(t,r){return t<<r|t>>>32-r}function i(t,r){var i,o,n,e,s;return n=2147483648&t,e=2147483648&r,i=1073741824&t,o=1073741824&r,s=(1073741823&t)+(1073741823&r),i&o?2147483648^s^n^e:i|o?1073741824&s?3221225472^s^n^e:1073741824^s^n^e:s^n^e}function o(t,r,i){return t&r|~t&i}function n(t,r,i){return t&i|r&~i}function e(t,r,i){return t^r^i}function s(t,r,i){return r^(t|~i)}function h(t,n,e,s,h,u,a){return t=i(t,i(i(o(n,e,s),h),a)),i(r(t,u),n)}function u(t,o,e,s,h,u,a){return t=i(t,i(i(n(o,e,s),h),a)),i(r(t,u),o)}function a(t,o,n,s,h,u,a){return t=i(t,i(i(e(o,n,s),h),a)),i(r(t,u),o)}function f(t,o,n,e,h,u,a){return t=i(t,i(i(s(o,n,e),h),a)),i(r(t,u),o)}function c(t){for(var r,i=t.length,o=i+8,n=(o-o%64)/64,e=16*(n+1),s=Array(e-1),h=0,u=0;u<i;)r=(u-u%4)/4,h=u%4*8,s[r]=s[r]|t.charCodeAt(u)<<h,u++;return r=(u-u%4)/4,h=u%4*8,s[r]=s[r]|128<<h,s[e-2]=i<<3,s[e-1]=i>>>29,s}function p(t){var r,i,o="",n="";for(i=0;i<=3;i++)r=t>>>8*i&255,n="0"+r.toString(16),o+=n.substr(n.length-2,2);return o}function l(t){t=t.replace(/\r\n/g,"\n");for(var r="",i=0;i<t.length;i++){var o=t.charCodeAt(i);o<128?r+=String.fromCharCode(o):o>127&&o<2048?(r+=String.fromCharCode(o>>6|192),r+=String.fromCharCode(63&o|128)):(r+=String.fromCharCode(o>>12|224),r+=String.fromCharCode(o>>6&63|128),r+=String.fromCharCode(63&o|128))}return r}var v,m,d,y,g,b,S,T,w,C=[],D=7,A=12,x=17,B=22,R=5,E=9,M=14,I=20,O=4,q=11,P=16,N=23,K=6,V=10,L=15,k=21;for(t=l(t),C=c(t),b=1732584193,S=4023233417,T=2562383102,w=271733878,v=0;v<C.length;v+=16)m=b,d=S,y=T,g=w,b=h(b,S,T,w,C[v+0],D,3614090360),w=h(w,b,S,T,C[v+1],A,3905402710),T=h(T,w,b,S,C[v+2],x,606105819),S=h(S,T,w,b,C[v+3],B,3250441966),b=h(b,S,T,w,C[v+4],D,4118548399),w=h(w,b,S,T,C[v+5],A,1200080426),T=h(T,w,b,S,C[v+6],x,2821735955),S=h(S,T,w,b,C[v+7],B,4249261313),b=h(b,S,T,w,C[v+8],D,1770035416),w=h(w,b,S,T,C[v+9],A,2336552879),T=h(T,w,b,S,C[v+10],x,4294925233),S=h(S,T,w,b,C[v+11],B,2304563134),b=h(b,S,T,w,C[v+12],D,1804603682),w=h(w,b,S,T,C[v+13],A,4254626195),T=h(T,w,b,S,C[v+14],x,2792965006),S=h(S,T,w,b,C[v+15],B,1236535329),b=u(b,S,T,w,C[v+1],R,4129170786),w=u(w,b,S,T,C[v+6],E,3225465664),T=u(T,w,b,S,C[v+11],M,643717713),S=u(S,T,w,b,C[v+0],I,3921069994),b=u(b,S,T,w,C[v+5],R,3593408605),w=u(w,b,S,T,C[v+10],E,38016083),T=u(T,w,b,S,C[v+15],M,3634488961),S=u(S,T,w,b,C[v+4],I,3889429448),b=u(b,S,T,w,C[v+9],R,568446438),w=u(w,b,S,T,C[v+14],E,3275163606),T=u(T,w,b,S,C[v+3],M,4107603335),S=u(S,T,w,b,C[v+8],I,1163531501),b=u(b,S,T,w,C[v+13],R,2850285829),w=u(w,b,S,T,C[v+2],E,4243563512),T=u(T,w,b,S,C[v+7],M,1735328473),S=u(S,T,w,b,C[v+12],I,2368359562),b=a(b,S,T,w,C[v+5],O,4294588738),w=a(w,b,S,T,C[v+8],q,2272392833),T=a(T,w,b,S,C[v+11],P,1839030562),S=a(S,T,w,b,C[v+14],N,4259657740),b=a(b,S,T,w,C[v+1],O,2763975236),w=a(w,b,S,T,C[v+4],q,1272893353),T=a(T,w,b,S,C[v+7],P,4139469664),S=a(S,T,w,b,C[v+10],N,3200236656),b=a(b,S,T,w,C[v+13],O,681279174),w=a(w,b,S,T,C[v+0],q,3936430074),T=a(T,w,b,S,C[v+3],P,3572445317),S=a(S,T,w,b,C[v+6],N,76029189),b=a(b,S,T,w,C[v+9],O,3654602809),w=a(w,b,S,T,C[v+12],q,3873151461),T=a(T,w,b,S,C[v+15],P,530742520),S=a(S,T,w,b,C[v+2],N,3299628645),b=f(b,S,T,w,C[v+0],K,4096336452),w=f(w,b,S,T,C[v+7],V,1126891415),T=f(T,w,b,S,C[v+14],L,2878612391),S=f(S,T,w,b,C[v+5],k,4237533241),b=f(b,S,T,w,C[v+12],K,1700485571),w=f(w,b,S,T,C[v+3],V,2399980690),T=f(T,w,b,S,C[v+10],L,4293915773),S=f(S,T,w,b,C[v+1],k,2240044497),b=f(b,S,T,w,C[v+8],K,1873313359),w=f(w,b,S,T,C[v+15],V,4264355552),T=f(T,w,b,S,C[v+6],L,2734768916),S=f(S,T,w,b,C[v+13],k,1309151649),b=f(b,S,T,w,C[v+4],K,4149444226),w=f(w,b,S,T,C[v+11],V,3174756917),T=f(T,w,b,S,C[v+2],L,718787259),S=f(S,T,w,b,C[v+9],k,3951481745),b=i(b,m),S=i(S,d),T=i(T,y),w=i(w,g);var F=p(b)+p(S)+p(T)+p(w);return F.toLowerCase()},Ur={MD5:Xr,sha256:zr,sha1:Hr};!function(t,r,i,o,n,e,s){function h(t){var r,o,n=this,e=t.length,s=0,h=n.i=n.j=n.m=0;for(n.S=[],n.c=[],e||(t=[e++]);s<i;)n.S[s]=s++;for(s=0;s<i;s++)r=n.S[s],h=f(h+r+t[s%e]),o=n.S[h],n.S[s]=o,n.S[h]=r;n.g=function(t){var r=n.S,o=f(n.i+1),e=r[o],s=f(n.j+e),h=r[s];r[o]=h,r[s]=e;for(var u=r[f(e+h)];--t;)o=f(o+1),e=r[o],s=f(s+e),h=r[s],r[o]=h,r[s]=e,u=u*i+r[f(e+h)];return n.i=o,n.j=s,u},n.g(i)}function u(t,r,i,o,n){if(i=[],n=typeof t,r&&"object"==n)for(o in t)if(o.indexOf("S")<5)try{i.push(u(t[o],r-1))}catch(t){}return i.length?i:t+("string"!=n?"\0":"")}function a(t,r,i,o){for(t+="",i=0,o=0;o<t.length;o++)r[f(o)]=f((i^=19*r[f(o)])+t.charCodeAt(o));t="";for(o in r)t+=String.fromCharCode(r[o]);return t}function f(t){return t&i-1}r.seedrandom=function(f,c){var p,l=[];return f=a(u(c?[f,t]:arguments.length?f:[(new Date).getTime(),t,window],3),l),p=new h(l),a(p.S,t),r.random=function(){for(var t=p.g(o),r=s,h=0;t<n;)t=(t+h)*i,r*=i,h=p.g(1);for(;t>=e;)t/=2,r/=2,h>>>=1;return(t+h)/r},f},s=r.pow(i,o),n=r.pow(2,n),e=2*n,a(r.random(),t)}([],Math,256,6,52),tr.prototype.nextBytes=rr,ir.prototype.init=or,
ir.prototype.next=nr;var Wr,Gr,Jr,Qr=256;if(null==Gr){Gr=[],Jr=0;var Yr;if("Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto){var $r=window.crypto.random(32);for(Yr=0;Yr<$r.length;++Yr)Gr[Jr++]=255&$r.charCodeAt(Yr)}for(;Jr<Qr;)Yr=Math.floor(65536*Math.random()),Gr[Jr++]=Yr>>>8,Gr[Jr++]=255&Yr;Jr=0,hr()}fr.prototype.nextBytes=ar;var ti={SeededRandom:tr,SecureRandom:fr},ri=_r,ii=Ur,oi=ti,ni=ri.BigInteger;lr.prototype.doPublic=mr,lr.prototype.setPublic=vr,lr.prototype.encrypt=dr,lr.prototype.doPrivate=Tr,lr.prototype.setPrivate=gr,lr.prototype.setPrivateEx=br,lr.prototype.generate=Sr,lr.prototype.decrypt=wr;var ei=[];ei.sha1="3021300906052b0e03021a05000414",ei.sha256="3031300d060960864801650304020105000420";var si=[];si.sha1=ii.sha1.hex,si.sha256=ii.sha256.hex,lr.prototype.signString=Dr,lr.prototype.signStringWithSHA1=Ar,lr.prototype.signStringWithSHA256=xr,lr.prototype.verifyString=Or,lr.prototype.verifyHexSignatureForMessage=Ir;var hi=lr,ui=function(){var t={};return t.Sbox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],t.ShiftRowTab=[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11],t.Init=function(){var r;for(t.Sbox_Inv=new Array(256),r=0;r<256;r++)t.Sbox_Inv[t.Sbox[r]]=r;for(t.ShiftRowTab_Inv=new Array(16),r=0;r<16;r++)t.ShiftRowTab_Inv[t.ShiftRowTab[r]]=r;for(t.xtime=new Array(256),r=0;r<128;r++)t.xtime[r]=r<<1,t.xtime[128+r]=r<<1^27},t.Done=function(){delete t.Sbox_Inv,delete t.ShiftRowTab_Inv,delete t.xtime},t.ExpandKey=function(r){var i,o=r.length,n=1;switch(o){case 16:i=176;break;case 24:i=208;break;case 32:i=240;break;default:alert("my.ExpandKey: Only key lengths of 16, 24 or 32 bytes allowed!")}for(var e=o;e<i;e+=4){var s=r.slice(e-4,e);e%o==0?(s=[t.Sbox[s[1]]^n,t.Sbox[s[2]],t.Sbox[s[3]],t.Sbox[s[0]]],(n<<=1)>=256&&(n^=283)):o>24&&e%o==16&&(s=[t.Sbox[s[0]],t.Sbox[s[1]],t.Sbox[s[2]],t.Sbox[s[3]]]);for(var h=0;h<4;h++)r[e+h]=r[e+h-o]^s[h]}},t.Encrypt=function(r,i){var o=i.length;t.AddRoundKey(r,i.slice(0,16));for(var n=16;n<o-16;n+=16)t.SubBytes(r,t.Sbox),t.ShiftRows(r,t.ShiftRowTab),t.MixColumns(r),t.AddRoundKey(r,i.slice(n,n+16));t.SubBytes(r,t.Sbox),t.ShiftRows(r,t.ShiftRowTab),t.AddRoundKey(r,i.slice(n,o))},t.Decrypt=function(r,i){var o=i.length;t.AddRoundKey(r,i.slice(o-16,o)),t.ShiftRows(r,t.ShiftRowTab_Inv),t.SubBytes(r,t.Sbox_Inv);for(var n=o-32;n>=16;n-=16)t.AddRoundKey(r,i.slice(n,n+16)),t.MixColumns_Inv(r),t.ShiftRows(r,t.ShiftRowTab_Inv),t.SubBytes(r,t.Sbox_Inv);t.AddRoundKey(r,i.slice(0,16))},t.SubBytes=function(t,r){for(var i=0;i<16;i++)t[i]=r[t[i]]},t.AddRoundKey=function(t,r){for(var i=0;i<16;i++)t[i]^=r[i]},t.ShiftRows=function(t,r){for(var i=[].concat(t),o=0;o<16;o++)t[o]=i[r[o]]},t.MixColumns=function(r){for(var i=0;i<16;i+=4){var o=r[i],n=r[i+1],e=r[i+2],s=r[i+3],h=o^n^e^s;r[i]^=h^t.xtime[o^n],r[i+1]^=h^t.xtime[n^e],r[i+2]^=h^t.xtime[e^s],r[i+3]^=h^t.xtime[s^o]}},t.MixColumns_Inv=function(r){for(var i=0;i<16;i+=4){var o=r[i],n=r[i+1],e=r[i+2],s=r[i+3],h=o^n^e^s,u=t.xtime[h],a=t.xtime[t.xtime[u^o^e]]^h,f=t.xtime[t.xtime[u^n^s]]^h;r[i]^=a^t.xtime[o^n],r[i+1]^=f^t.xtime[n^e],r[i+2]^=a^t.xtime[e^s],r[i+3]^=f^t.xtime[s^o]}},t}(),ai=ui,fi=hi,ci=Ur,pi=ai,li=ti,vi=_r,mi=function(){var t={};pi.Init();var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return t.RSAKey=fi,t.b256to64=function(t){var i,o,n,e="",s=0,h=0,u=t.length;for(n=0;n<u;n++)o=t.charCodeAt(n),0==h?(e+=r.charAt(o>>2&63),i=(3&o)<<4):1==h?(e+=r.charAt(i|o>>4&15),i=(15&o)<<2):2==h&&(e+=r.charAt(i|o>>6&3),s+=1,e+=r.charAt(63&o)),s+=1,h+=1,3==h&&(h=0);return h>0&&(e+=r.charAt(i),s+=1,e+="=",s+=1),1==h&&(e+="="),e},t.b64to256=function(t){var i,o,n="",e=0,s=0,h=t.length;for(o=0;o<h;o++)i=r.indexOf(t.charAt(o)),i>=0&&(e&&(n+=String.fromCharCode(s|i>>6-e&255)),e=e+2&7,s=i<<e&255);return n},t.b16to64=function(t){var i,o,n="";for(t.length%2==1&&(t="0"+t),i=0;i+3<=t.length;i+=3)o=parseInt(t.substring(i,i+3),16),n+=r.charAt(o>>6)+r.charAt(63&o);for(i+1==t.length?(o=parseInt(t.substring(i,i+1),16),n+=r.charAt(o<<2)):i+2==t.length&&(o=parseInt(t.substring(i,i+2),16),n+=r.charAt(o>>2)+r.charAt((3&o)<<4));(3&n.length)>0;)n+="=";return n},t.b64to16=function(t){var i,o,n="",e=0;for(i=0;i<t.length&&"="!=t.charAt(i);++i){var s=r.indexOf(t.charAt(i));s<0||(0==e?(n+=vi.int2char(s>>2),o=3&s,e=1):1==e?(n+=vi.int2char(o<<2|s>>4),o=15&s,e=2):2==e?(n+=vi.int2char(o),n+=vi.int2char(s>>2),o=3&s,e=3):(n+=vi.int2char(o<<2|s>>4),n+=vi.int2char(15&s),e=0))}return 1==e&&(n+=vi.int2char(o<<2)),n},t.string2bytes=function(t){for(var r=[],i=0;i<t.length;i++)r.push(t.charCodeAt(i));return r},t.bytes2string=function(t){for(var r="",i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r},t.blockXOR=function(t,r){for(var i=new Array(16),o=0;o<16;o++)i[o]=t[o]^r[o];return i},t.blockIV=function(){var t=new li.SecureRandom,r=new Array(16);return t.nextBytes(r),r},t.pad16=function(t){var r,i=t.slice(0),o=(16-t.length%16)%16;for(r=t.length;r<t.length+o;r++)i.push(0);return i},t.depad=function(t){for(var r=t.slice(0);0==r[r.length-1];)r=r.slice(0,r.length-1);return r},t.encryptAESCBC=function(r,i){var o=i.slice(0);pi.ExpandKey(o);var n=t.string2bytes(r);n=t.pad16(n);for(var e=t.blockIV(),s=0;s<n.length/16;s++){var h=n.slice(16*s,16*s+16),u=e.slice(16*s,16*s+16);h=t.blockXOR(u,h),pi.Encrypt(h,o),e=e.concat(h)}var a=t.bytes2string(e);return t.b256to64(a)},t.decryptAESCBC=function(r,i){var o=i.slice(0);pi.ExpandKey(o),r=t.b64to256(r);for(var n=t.string2bytes(r),e=[],s=1;s<n.length/16;s++){var h=n.slice(16*s,16*s+16),u=n.slice(16*(s-1),16*(s-1)+16);pi.Decrypt(h,o),h=t.blockXOR(u,h),e=e.concat(h)}return e=t.depad(e),t.bytes2string(e)},t.wrap60=function(t){for(var r="",i=0;i<t.length;i++)i%60==0&&0!=i&&(r+="\n"),r+=t[i];return r},t.generateAESKey=function(){var t=new Array(32),r=new li.SecureRandom;return r.nextBytes(t),t},t.generateRSAKey=function(t,r){Math.seedrandom(ci.sha256.hex(t));var i=new fi;return i.generate(r,"03"),i},t.publicKeyString=function(r){return t.b16to64(r.n.toString(16))},t.publicKeyID=function(t){return ci.MD5(t)},t.publicKeyFromString=function(r){var i=t.b64to16(r.split("|")[0]),o="03",n=new fi;return n.setPublic(i,o),n},t.encrypt=function(r,i,o){var n="",e=t.generateAESKey();try{var s=t.publicKeyFromString(i);n+=t.b16to64(s.encrypt(t.bytes2string(e)))+"?"}catch(t){return{status:"Invalid public key"}}if(o){var h=mi.b16to64(o.signString(r,"sha256"));r+="::52cee64bb3a38f6403386519a39ac91c::",r+=mi.publicKeyString(o),r+="::52cee64bb3a38f6403386519a39ac91c::",r+=h}return n+=t.encryptAESCBC(r,e),{status:"success",cipher:n}},t.decrypt=function(r,i){var o=r.split("?"),n=i.decrypt(t.b64to16(o[0]));if(null==n)return{status:"failure"};n=t.string2bytes(n);var e=t.decryptAESCBC(o[1],n).split("::52cee64bb3a38f6403386519a39ac91c::");if(3==e.length){var s=t.publicKeyFromString(e[1]),h=t.b64to16(e[2]);return s.verifyString(e[0],h)?{status:"success",plaintext:e[0],signature:"verified",publicKeyString:t.publicKeyString(s)}:{status:"success",plaintext:e[0],signature:"forged",publicKeyString:t.publicKeyString(s)}}return{status:"success",plaintext:e[0],signature:"unsigned"}},t}(),di=mi;return di});
